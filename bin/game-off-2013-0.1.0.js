/**
 * game-off-2013 - v0.1.0 - 2013-11-04
 * 
 *
 * Copyright (c) 2013 Froggies Team
 * Licensed  <>
 */
var BacklogController=function(){"use strict";function a(){this.view=new BacklogView(this),this.cards=[]}return a.prototype.addCard=function(){var a=new CardController;return this.cards.push(a),a.start(this.view.container),a},a.prototype.removeCard=function(a){var b=this.cards.indexOf(a);b>-1&&this.cards.splice(b,1)},a.prototype.start=function(a){this.view.draw(a)},a}(),CardController=function(){"use strict";function a(){this.view=new CardView(this)}return a.prototype.start=function(a){this.view.draw(a)},a}(),ColumnController=function(){"use strict";function a(){this.view=new ColumnView(this),this.header=new HeaderColumnController,this.rows=[];for(var a=0;b>a;a++)this.rows.push(new RowController)}var b=5;return a.prototype.start=function(a){this.view.draw(a),this.header.start(this.view.container);for(var b=0;b<this.rows.length;b++)this.rows[b].start(this.view.container)},a.prototype.activeNextRow=function(){for(var a=0;a<this.rows.length;a++)if(this.rows[a].isActive===!1)return this.rows[a].activate(),void 0},a.prototype.addCard=function(a){for(var b=0;b<this.rows.length;b++)if(this.rows[b].canAcceptCard()===!0)return this.rows[b].addCard(a),!0;return!1},a}(),GameController=function(){"use strict";function a(){this.fps=1e3,this.nbLoop=0,this.timeout=void 0,this.view=new GameView(this),this.backlog=new BacklogController,this.columns=[new ColumnController,new ColumnController,new ColumnController,new ColumnController,new ColumnController]}return a.prototype.start=function(a){this.view.draw(a);for(var b=0;b<this.columns.length;b++)this.columns[b].start(this.view.container);this.backlog.start(this.view.container),this.resume()},a.prototype.pause=function(){window.clearInterval(this.timeout),this.timeout=void 0},a.prototype.resume=function(){if(void 0===this.timeout){var a=this;this.timeout=window.setInterval(function(){a.loop()},this.fps)}},a.prototype.loop=function(){return this.nbLoop=this.nbLoop+1,this.backlog.addCard(),this.backlog.cards.length>10?(this.pause(),window.alert("Game over"),"finish"):void 0},a}(),HeaderColumnController=function(){"use strict";function a(){this.view=new HeaderColumnView(this)}return a.prototype.start=function(a){this.view.draw(a)},a}(),RowController=function(){"use strict";function a(){this.view=new RowView(this),this.isActive=!1,this.card=void 0}return a.prototype.start=function(a){this.view.draw(a)},a.prototype.activate=function(){this.isActive=!0},a.prototype.canAcceptCard=function(){return this.isActive&&void 0===this.card},a.prototype.addCard=function(a){this.card=a,a.start(this.view.container)},a}();window.onload=function(){var a=document.createElement("button");a.innerHTML="Add card",document.getElementsByTagName("body")[0].appendChild(a);var b=new GameController;b.start(document.getElementsByTagName("body")[0]),a.onclick=function(){console.log("click"),b.backlog.addCard()}};var UtilDragAndDrop=function(){var a;return{makeDraggable:function(b){b.draggable=!0,b.ondragstart=function(){a=b}},makeUndraggable:function(a){a.draggable=!1,a.ondragstart=void 0},makeDroppable:function(b){b.ondragenter=function(){return event.preventDefault(),!0},b.ondragover=function(){return!1},b.ondrop=function(c){return b.appendChild(a),UtilDragAndDrop.makeUndraggable(a),c.stopPropagation(),!1}}}}(),UtilView=function(){return{buildContainer:function(a){var b=document.createElement("div");return b.className=a,b}}}(),BacklogView=function(){"use strict";function a(a){this.controller=a,this.container=UtilView.buildContainer("backlog")}return a.prototype.draw=function(a){a.appendChild(this.container)},a}(),CardView=function(){"use strict";function a(a){this.controller=a,this.container=UtilView.buildContainer("card"),UtilDragAndDrop.makeDraggable(this.container)}return a.prototype.draw=function(a){a.appendChild(this.container)},a}(),ColumnView=function(){"use strict";function a(a){this.controller=a,this.container=UtilView.buildContainer("column")}return a.prototype.draw=function(a){a.appendChild(this.container)},a}(),GameView=function(){"use strict";function a(a){this.controller=a,this.container=UtilView.buildContainer("game")}return a.prototype.draw=function(a){a.appendChild(this.container)},a}(),HeaderColumnView=function(){"use strict";function a(a){this.controller=a,this.container=UtilView.buildContainer("headerColumn")}return a.prototype.draw=function(a){a.appendChild(this.container)},a}(),RowView=function(){"use strict";function a(a){this.controller=a,this.container=UtilView.buildContainer("row"),UtilDragAndDrop.makeDroppable(this.container)}return a.prototype.draw=function(a){a.appendChild(this.container)},a}();